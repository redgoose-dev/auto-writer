(function(f,u){typeof exports=="object"&&typeof module<"u"?module.exports=u():typeof define=="function"&&define.amd?define(u):(f=typeof globalThis<"u"?globalThis:f||self,f.autoWriter=u())})(this,(function(){"use strict";function f(r){const e=Math.floor(Math.random()*r.length);return r.substring(e,e+1)}function u(r,e={}){return new Promise(g=>{if(e=Object.assign({},{text:"shuffle text",waitChar:"-",charSpeed:1,moveFix:25,moveRange:10,moveTrigger:25,fps:60,pattern:"abcdefghijklmnopqrstuvwxyz0123456789-_!@#$%^&*()+~<>",randomTextType:"unicode",stream:null},e),e.text=e.text.trim(),!e.text)return g();let n=[],l,d,m,h,y=!1,i;function o(){let a=m.split("").map(t=>({t}));h=!0;for(let t=d;t<=l;t++){if(n[t]!==0&&n[t]!=null){h=!1;const s=n[t];if(Math.abs(s)<=e.moveTrigger){let x="";switch(e.randomTextType){case"pattern":x=f(e.pattern);break;case"unicode":default:const M=Math.min(Math.max(e.text.charCodeAt(t)+s,33),126);x=String.fromCharCode(M);break}a.push({t:x,m:"new"})}else a.push({t:e.waitChar,m:"wait"});s>0?n[t]-=1:n[t]+=1}else d===t-1&&(d=t,m=e.text.substring(0,d)),a.push({t:e.text.charAt(t),m:"done"});c(a)}l<=e.text.length?l+=e.charSpeed:y=!0,h&&y&&v()}function v(){i&&clearInterval(i),r&&delete r.dataset.id,c(m),g(e.text)}function c(a){r&&(r.textContent=Array.isArray(a)?a.map(t=>t.t).join(""):a),e.stream&&typeof e.stream=="function"&&e.stream(Array.isArray(a)?a:a.split("").map(t=>({t})))}r?.dataset.id&&(i=parseInt(r.dataset.id)),c(e.waitChar);for(let a=0;a<=e.text.length-1;a++)e.text.charAt(0)!==" "?n[a]=(e.moveFix+Math.round(Math.random()*e.moveRange))*(Math.round(Math.random())-.5)*2:n[a]=0;l=0,d=0,m="",i&&clearInterval(i),i=setInterval(o,1e3/e.fps),r&&(r.dataset.id=i.toString())})}return u}));
